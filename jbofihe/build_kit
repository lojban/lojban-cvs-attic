#!/usr/local/bin/perl

@files = <*>;
open(COPY, "<COPYRIGHT");
@copy=<COPY>;
close(COPY);
for $f (@files) {
    print "doing $f\n";
    rename "$f","$f.tmp";
    open (IN, "<$f.tmp");
    open (OUT, ">$f");
    while (<IN>) {
	if (m,\/\* COPYRIGHT \*\/,) {
	    print OUT "/**********************************************************************\n";
	    for (@copy) {
		print OUT " * ".$_;
	    }
	    print OUT " *********************************************************************/\n";
	} elsif (m,\# COPYRIGHT,) {
	    print OUT "#\n";
	    for (@copy) {
		print OUT "# ".$_;
	    }
	    print OUT "#\n";
	} else {
	    print OUT;
	}
    }
    close(IN);
    close(OUT);
    unlink "$f.tmp";
}
unlink 'COPYRIGHT'; # This is included into everything else
unlink 'build_kit'; # Private
